<%- include("partials/header") %>



<div class="centered-form">
<div class="container">
  <h1>Welcome, <%= user.first_name %>!</h1>

  <% if (user.membership_status) { %>
    <p>You are now a members-only user.</p>
    <a href="/members" class="btn">Go to Members Page</a>

  <% } else { %>
    <p>Request a membership to access exclusive posts!</p>

    <!-- Request Membership Code Form -->
    <form action="/request-membership" method="POST" class="membership-form">
      <button type="submit">Request Membership Code</button>
    </form>

    <% if (showCodeForm) { %>
      <!-- Enter Membership Code Form -->
      <form action="/become-member" method="POST" class="membership-form">
        <label for="code">Enter Membership Code:</label>
        <input type="text" id="code" name="code" placeholder="Enter code" required>
        <!-- Hidden email field ensures server knows which code to verify -->
        <input type="hidden" name="email" value="<%= user.email_address %>">
        <button type="submit">Submit Code</button>
      </form>
    <% } %>
  <% } %>

  <!-- Message display -->
  <% if (message) { %>
    <p class="success"><%= message %></p>
  <% } %>

  <a href="/log-out" class="logout">Logout</a>
</div>
</div>

<%- include("partials/footer") %>
